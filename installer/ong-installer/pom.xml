<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright   Actility, SA. All Rights Reserved.
  DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER
  
  This program is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License version
  2 only, as published by the Free Software Foundation.
  
  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  General Public License version 2 for more details (a copy is
  included at /legal/license.txt).
  
  You should have received a copy of the GNU General Public License
  version 2 along with this work; if not, write to the Free Software
  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
  02110-1301 USA
  
  Please contact Actility, SA.,  4, rue Ampere 22300 LANNION FRANCE
  or visit www.actility.com if you need additional
  information or have any questions.
  
  id $Id$
  author $Author$
  version $Revision$
  lastrevision $Date$
  modifiedby $LastChangedBy$
  lastmodified $LastChangedDate$
-->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>com.actility.m2m</groupId>
    <artifactId>java.pom</artifactId>
    <version>[2.0.0,3)</version>
  </parent>
  <artifactId>ong-installer</artifactId>
  <version>4.0.0</version>
  <packaging>jar</packaging>

  <name>ONG Installer</name>

  <properties>
    <watteco.version>1.4.11-1</watteco.version>
    <knx.version>1.0.3-1</knx.version>
    <pthsem.version>2.0.8-2</pthsem.version>
    <eibd.version>0.0.5-2</eibd.version>
    <iec61131.version>1.0.36-1</iec61131.version>
    <mxml.version>2.7-3</mxml.version>
    <modbus.version>1.2.0-1</modbus.version>
    <ntpclient.version>2010.365-9</ntpclient.version>
  </properties>

  <dependencies>
    <dependency>
      <groupId>org.easymock</groupId>
      <artifactId>easymock</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>com.jcraft</groupId>
      <artifactId>jsch</artifactId>
      <version>0.1.44-1</version>
    </dependency>
    <dependency>
      <groupId>org.apache.commons</groupId>
      <artifactId>commons-compress</artifactId>
      <version>1.4.1</version>
    </dependency>

    <!-- Actility APIs + external dependencies for boot-repository -->
    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>gscl</artifactId>
      <version>3.0.0</version>
      <classifier>${build.type}</classifier>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>drvcommon</artifactId>
      <version>1.4.14-1</version>
      <classifier>${build.type}</classifier>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>zigbee</artifactId>
      <version>1.8.5-1</version>
      <classifier>${build.type}</classifier>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>wmbus</artifactId>
      <version>1.2.4-1</version>
      <classifier>${build.type}</classifier>
      <type>apu</type>
    </dependency>


    <dependency>
      <groupId>org.tcpdump</groupId>
      <artifactId>tcpdump</artifactId>
      <version>4.3.0-1</version>
      <classifier>${build.type}</classifier>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>tty_mapper</artifactId>
      <version>1.0.1-1</version>
      <classifier>${build.type}</classifier>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>supervision</artifactId>
      <version>3.4.3-0</version>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>apu-install</artifactId>
      <version>1.1-1</version>
      <type>apu</type>
    </dependency>

    <dependency>
      <groupId>com.actility.m2m</groupId>
      <artifactId>acy-init</artifactId>
      <version>1.0.1-0</version>
      <type>apu</type>
    </dependency>
  </dependencies>

  <profiles>

    <profile>
      <id>centos6-x86</id>
      <activation>
        <property>
          <name>build.type</name>
          <value>centos6-x86</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>watteco</artifactId>
          <version>${watteco.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>knx</artifactId>
          <version>${knx.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>pthsem</artifactId>
          <version>${pthsem.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>eibd</artifactId>
          <version>${eibd.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>iec61131</artifactId>
          <version>${iec61131.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.msweet</groupId>
          <artifactId>mxml</artifactId>
          <version>${mxml.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>modbus</artifactId>
          <version>${modbus.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>centos6-x86_64</id>
      <activation>
        <property>
          <name>build.type</name>
          <value>centos6-x86_64</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>watteco</artifactId>
          <version>${watteco.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>knx</artifactId>
          <version>${knx.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>pthsem</artifactId>
          <version>${pthsem.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>eibd</artifactId>
          <version>${eibd.version}</version>
          <classifier>${build.type}</classifier>                                                    
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>modbus</artifactId>
          <version>${modbus.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>cov1</id>
      <activation>
        <property>
          <name>build.type</name>
          <value>cov1</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.icarus</groupId>
          <artifactId>ntpclient</artifactId>
          <version>${ntpclient.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>cov2</id>
      <activation>
        <property>
          <name>build.type</name>
          <value>cov2</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>watteco</artifactId>
          <version>${watteco.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>knx</artifactId>
          <version>${knx.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>pthsem</artifactId>
          <version>${pthsem.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>eibd</artifactId>
          <version>${eibd.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>iec61131</artifactId>
          <version>${iec61131.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.msweet</groupId>
          <artifactId>mxml</artifactId>
          <version>${mxml.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>modbus</artifactId>
          <version>${modbus.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.icarus</groupId>
          <artifactId>ntpclient</artifactId>
          <version>${ntpclient.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>lpv3</id>
      <activation>
        <property>
          <name>build.type</name>
          <value>lpv3</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>watteco</artifactId>
          <version>${watteco.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>knx</artifactId>
          <version>${knx.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>pthsem</artifactId>
          <version>${pthsem.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>eibd</artifactId>
          <version>${eibd.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>iec61131</artifactId>
          <version>${iec61131.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.msweet</groupId>
          <artifactId>mxml</artifactId>
          <version>${mxml.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>modbus</artifactId>
          <version>${modbus.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>rpib</id>
      <activation>
        <property>
          <name>build.type</name>
          <value>rpib</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>watteco</artifactId>
          <version>${watteco.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>knx</artifactId>
          <version>${knx.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>pthsem</artifactId>
          <version>${pthsem.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>eibd</artifactId>
          <version>${eibd.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>iec61131</artifactId>
          <version>${iec61131.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.msweet</groupId>
          <artifactId>mxml</artifactId>
          <version>${mxml.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>modbus</artifactId>
          <version>${modbus.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.icarus</groupId>
          <artifactId>ntpclient</artifactId>
          <version>${ntpclient.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>ntc6200</id>
      <properties>
      	<build.type>ntc6200</build.type>
      </properties>
      <activation>
        <property>
          <name>build.type</name>
          <value>ntc6200</value>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>watteco</artifactId>
          <version>${watteco.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>knx</artifactId>
          <version>${knx.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>pthsem</artifactId>
          <version>${pthsem.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.gnu</groupId>
          <artifactId>eibd</artifactId>
          <version>${eibd.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>iec61131</artifactId>
          <version>${iec61131.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>org.msweet</groupId>
          <artifactId>mxml</artifactId>
          <version>${mxml.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
        <dependency>
          <groupId>com.actility.m2m</groupId>
          <artifactId>modbus</artifactId>
          <version>${modbus.version}</version>
          <classifier>${build.type}</classifier>
          <type>apu</type>
        </dependency>
      </dependencies>
    </profile>

  </profiles>

  <build>
    <resources>
      <resource>
        <directory>src/main/resources</directory>
        <includes>
          <include>**/*.properties</include>
        </includes>
        <filtering>true</filtering>
      </resource>
      <resource>
        <directory>src/main/resources</directory>
        <excludes>
          <exclude>**/*.properties</exclude>
        </excludes>
        <filtering>false</filtering>
      </resource>
    </resources>

    <plugins>
      <plugin>
        <artifactId>maven-enforcer-plugin</artifactId>
        <executions>
          <execution>
            <id>enforce-build.type</id>
            <goals>
              <goal>enforce</goal>
            </goals>
            <configuration>
              <rules>
                <requireProperty>
                  <property>build.type</property>
                  <message>You must set a build.type property!</message>
                </requireProperty>
              </rules>
              <fail>true</fail>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jar-plugin</artifactId>
        <configuration>
          <archive>
            <manifest>
<!--              <addClasspath>true</addClasspath>-->
              <mainClass>com.actility.ong.installer.MainInstallDialog</mainClass>
            </manifest>
          </archive>
        </configuration>
      </plugin>

      <!-- Copy empty directories from resources -->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-resources-plugin</artifactId>
        <configuration>
          <includeEmptyDirs>true</includeEmptyDirs>
        </configuration>
      </plugin>

      <plugin>
        <artifactId>maven-dependency-plugin</artifactId>
        <executions>

          <!-- Unpack dependencies into final bundle -->
          <execution>
            <id>unpack-dependencies</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>unpack-dependencies</goal>
            </goals>
            <configuration>
              <includeArtifactIds>jsch,commons-compress</includeArtifactIds>
              <excludeTransitive>false</excludeTransitive>
              <outputDirectory>${project.build.directory}/classes</outputDirectory>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>com.actility.m2m</groupId>
        <artifactId>cocoon-maven-plugin</artifactId>
        <configuration>
          <includeArchitecture>${build.type}</includeArchitecture>
          <excludeProducts>ong-osgime</excludeProducts>
          <excludeModules>ong.osgime</excludeModules>
          <excludeTypes>pom</excludeTypes>
          <excludeArtifactIds>jsch,xz,desktop-API,servlet-api,commons-httpclient,commons-logging,commons-codec,gscl.osgime</excludeArtifactIds>
          <excludeGroupIds>org.apache.commons,org.osgi</excludeGroupIds>
          <defaultModule>gscl.osgi</defaultModule>
          <modules>
            org.xmlsoft:libxml2:core,
            com.actility.m2m:rtbase:core,
            com.actility.m2m:xo:core,
            com.actility.m2m:libdIa:core,
            com.actility.m2m:m2mxoref:core,
            com.actility.m2m:stdin-logger:core,
            org.sqlite:sqlite:core,
            com.actility.m2m:zigbee:zigbee,
            com.actility.m2m:wmbus:wmbus,
            com.actility.m2m:watteco:watteco,
            com.actility.m2m:knx:knx,
            org.gnu:eibd:knx,
            org.gnu:pthsem:knx,
            com.actility.m2m:modbus:modbus,
            com.actility.m2m:iec61131:iec61131,
            org.msweet:mxml:iec61131,
            com.actility.m2m:tty_mapper:tty_mapper,
            com.icarus:ntpclient:ntpclient,
            org.tcpdump:tcpdump:tcpdump,
          </modules>
        </configuration>
        <executions>
          <execution>
            <id>cocoon-generation</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>generate-cocoon-rootact</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
</project>
